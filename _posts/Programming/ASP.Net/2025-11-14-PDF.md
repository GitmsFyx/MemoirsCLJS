---
categories: ASP.net
---

# PDF

## 准备

1.  首先下载这个包`Rotativa.AspNetCore` 
2.  在网上下载`wkhtmltopdf`软件
3.  在项目`wwwroot`中创建一个`Rotativa`文件夹，并且将`wkhtmltopdf`子文件`bin`里面的`wkhtmltopdf.exe`放到其中。
4.  准备一个html页面

## 代码

```C#
//Program.cs
//启动Rotativa
app.UseRotativa();
```
控制器请求
```C#
[Route("[action]")]
public async Task<IActionResult> PersonsPDF()
{
    var personResponses = await _personsService.GetAllPersons();

    //这里返回的是ViewAsPdf,第一个参数是准备好的页面，第二个是模型类，第三个是传递ViewData
    return new ViewAsPdf("PersonsPDF", personResponses,ViewData)
    {   
        //边距
        PageMargins = new Margins(){Top = 20,Right = 20,Bottom=20,Left = 20},
        //排列方向
        PageOrientation = Orientation.Landscape
    };
}
```