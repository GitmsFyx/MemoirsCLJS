---
categories: ASP.net
---

# Service

服务层,创建一个新类库项目,方便复用,测试,架构清晰.

>[!TIP]
>建议写在一个新项目里面,可以让多个项目引用.

## DI 依赖注入

可以松耦合,也方便协同开发.依赖抽象接口.

这样只需定义一个接口就可以同时开发  
Controller -> interface <- Service

```C#
//Program.cs

//注册服务
builder.Services.Add(new ServiceDescriptor(typeof(ICitiesService), typeof(CitiesService),ServiceLifetime.Transient));
```

```C#
public class HomeController : Controller
{
    private readonly ICitiesService _citiesService;
    
    //会自动在构造函数中注入
    public HomeController(ICitiesService citiesService)
    {
        _citiesService = citiesService; //new CitiesService();
    }
    
}
```

[FromServices] 某个方法的参数由依赖注入而来. *实际使用很少*
```C#
[Route("/")]
//特指这个参数由依赖注入服务得来
public ActionResult Index([FromServices]ICitiesService _citiesService)
{
    var cities = _citiesService.GetCities();
    return View(cities);
}
```